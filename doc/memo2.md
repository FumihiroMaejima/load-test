
# メモ

[出典](https://qiita.com/s_yokoi/items/4e21aed46e561badce94)

## 負荷試験のスケジュール



| No. | 作業 | 内容 | 成果物 | 工数(人/日) |
| :--- | :---: |  :---: | :---: | :--- |
| 1 | 計画立案 | 性能リスクが懸念されるシナリオの洗い出し<br>目標やテストの種類の決定<br>必要リソースの洗い出し<br>計画書のレビュー | 負荷テスト計画書 | 5 |
| 2 | 準備 | 関連部門への通知や支援要請<br>リソース確保<br>テストの開発環境の構築<br>勉強会 | 開発環境利用手順<br>テストツールの操作手順書 | 7 |
| 3 | シナリオ作成 | シナリオ詳細設計<br>作業指示書作成<br>リスク対策 | 負荷テストの詳細設計<br>作業指示書 | 9 |
| 4 | シナリオプログラム作成 | シナリオスクリプト作成  | シナリオプログラム | 9 |
| 5 | テストデータ作成 | サイト側テストデータ作成<br>クライアント側テストデータ作成 | テストデータ | 6 |
| 6 | シミュレーション | 予備テスト実施<br>分析シミュレーション<br>シナリオの妥当性確認 | 各成果物の修正版   | 6 |
| 7 | 負荷テストの実施 | リハーサル<br>負荷テスト実施<br>テスト後作業 | 一時報告書 | 3 |
| 8 | 分析 | 計測結果分析<br>報告書作成<br>報告会実施<br>今後の方向性の決定 | 最終報告書 | 7 |



## テストの目的


| No. | 詳細 |
| :---  | :--- |
| 1 | 通常時に十分なパフォーマンスが得られるか確認する |
| 2 | ピーク時に十分なパフォーマンスが得られるか確認する |
| 3 | 長期間運用しても十分なパフォーマンスが得られ、必要以上のリソースの消費がないことを確認する |
| 4 | 指定した限界要件に耐えられるか確認する |
| 5 | システム限界点を見極める |
| 6 | 限界を超えた場合にどのような現象が発生するか知る |
| 7 | スパイクテストを行い短時間に処理が集中した場合に発生する現象を確認する |


次の要素の目標値を設定する。
分析時の判定の基準となる。

- レスポンスタイム(平均, 最大)
- スループット(平均, 最大)
- CPUやメモリ等のコンピューティングリソースの使用率(平均, 最大)
- ディスク容量等のコンピューティングリソースの消費量
- エラーの発生頻度
- その他 (ガベージコレクションの発生頻度等)



| 分離 | 対象項目 | 条件 | 計測点 | 通常 | ピーク | 限界 |
| :--- | :---: |  :---: |  :---: |  :---: | :---: | ---: |
| 基本値 | 同時アクセス数 | 全体 | Webサーバー | 100 | 200 | 300 |
|  | 平均レスポンス時間 | 各画面 | クライアント | 2秒以内 | 3秒以内 | 7秒以内 |
|  | スループット量(率) | 全体 | Webサーバー | 30Pv/s | 100Pv/s | 150Pv/s |
|  | エラー数(率) | 各画面 | Webサーバー | 平均0.1%以下 | 平均0.1%以下 | 1.0%以下 |
| リソース | CPU | 全体 | DB | 20% | 35% | - |
|  | メモリ | 全体 | DB | 2.4GB | 2.4GB | 2.4GB |
|  | ディスクI/O | 全体 | DB | - | - | - |
|  | ネットワーク | 全体 | DB | - | - | - |
|  | 競合やロック | 全体 | DB | 0.1%未満 | 0.1%未満 | 0.1%未満 |
|  | ヒット率 | 全体 | DB | 90以上 | 90以上 | 80以上 |
| その他 | ロードバランサの偏り | 全体 | LB | 6:4以内 | 6:4以内 | 6:4以内 |


### シナリオ作成


| 要素 | 検討事項 |
| :---  | :--- |
| シナリオパターンの詳細設計 | ページの遷移数<br>ページ遷移のタイミングや思考遅延<br>仮想ユーザの増減方法<br>負荷をかける回数や時間<br>シナリオパターン毎のテスト実施回数<br>エラーへの考慮 |
| データ設計 | バックエンド側に配置するテストデータ（蓄積データ）の内容・分量・偏り<br>クライアント側（エージェント側）に配置するテストデータ（入力データ）の内容・分量・偏り<br>適度なエラーデータの盛り込み |
| 実施に関する設計 | どのクライアントから負荷をかけるか(ランダムにかけられるか)<br>各計測ポイントでどんなデータを採取するか<br>どんなフォーマットで保存するかどのタイミングで計測データを採取するか |
| 分析に関する設計 | 計測データの分析方法と資料化方法の確定<br>計測データの保管先の確保 |

---


---
